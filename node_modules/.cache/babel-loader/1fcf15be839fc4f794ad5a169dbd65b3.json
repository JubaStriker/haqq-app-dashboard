{"ast":null,"code":"var _jsxFileName = \"/Users/jithendra/Desktop/Work/meta-soft-xrp/xrp-shopify-coupon-client/src/routes/settings/index.js\",\n    _s2 = $RefreshSig$();\n\nimport { useEffect, useContext, useState } from \"react\";\nimport { Box, Heading, ButtonGroup, Text, Button, Container, useToast, Code, Divider, Input, FormControl, InputLeftElement, InputGroup, FormHelperText, Alert, AlertIcon, SimpleGrid } from \"@chakra-ui/react\";\nimport useScriptsStore from \"../../store/scripts\";\nimport { ShopContext } from \"../../context\";\nimport { INTERNAL_SERVER_ERROR } from \"../../constants/strings\";\nimport NavBar from \"../../components/navbar\";\nimport { Form, useFormik } from \"formik\";\nimport * as Yup from \"yup\";\nimport WAValidator from \"multicoin-address-validator\";\nimport useWalletStore from \"../../store/wallet\";\nimport Parse from \"parse\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst SettingsRoute = () => {\n  _s2();\n\n  var _s = $RefreshSig$();\n\n  const shop = useContext(ShopContext);\n  const scripts = useScriptsStore(state => state.scripts);\n  const postScripts = useScriptsStore(state => state.postScripts);\n  const getScripts = useScriptsStore(state => state.getScripts);\n  const destroyScripts = useScriptsStore(state => state.destroyScripts);\n  const toast = useToast();\n  const [xrpAddress, setXrpAddress] = useState();\n  const xrpWalletAddress = useWalletStore(state => state.walletState);\n  const postWalletAddress = useWalletStore(state => state.postWalletAddress);\n  useEffect(() => {\n    const fetchData = async () => {\n      const query = new Parse.Query('WalletDetails');\n      query.fullText('shop', shop);\n      query.ascending('createdAt');\n      const result = await query.find().then(function (results) {\n        // console.log(result);\n        console.log('Successfully got' + result.length + 'Data');\n      }).catch(function (error) {// There was an error.\n      });\n      ; // console.log('Successfully got' + result.length + 'Data');\n      // for(const i=0; i<result.length; i++){\n      //   const object = result[i];\n      //   alert(object.id + ' - ' + object.get('shop'));\n      // }\n    };\n\n    fetchData();\n  });\n\n  const onSubmitHandler = data => {\n    const address = data;\n    const valid = WAValidator.validate(address, \"ripple\");\n\n    if (valid === true) {\n      toast({\n        title: \"Wallet Address Is Valid\",\n        status: \"success\"\n      });\n      postWalletAddress({\n        shop,\n        address\n      });\n\n      if (xrpWalletAddress.post.success.ok === true) {\n        toast({\n          title: 'Wallet address added successfully!',\n          status: 'success',\n          duration: 9000\n        });\n      } else {\n        toast({\n          title: 'Wallet Address not added! Please try after sometime',\n          status: 'error',\n          duration: 9000\n        });\n      }\n    } else {\n      toast({\n        title: \"Wallet Address is Invalid\",\n        status: \"error\"\n      });\n    }\n  };\n\n  useEffect(() => {\n    getScripts(shop);\n  }, []);\n\n  const enableWidget = async () => {\n    try {\n      await postScripts(shop);\n      toast({\n        title: `Widget added successfully! Please visit your online store after 30 seconds to check the widget.`,\n        status: \"success\"\n      });\n      getScripts(shop);\n    } catch (e) {\n      toast({\n        title: e.message || INTERNAL_SERVER_ERROR,\n        status: \"error\"\n      });\n    }\n  };\n\n  const walletSchema = Yup.object().shape({\n    walletAddress: Yup.string().required(\"Wallet Address Is required\")\n  });\n\n  const XrpAddressInput = () => {\n    _s();\n\n    const formik = useFormik({\n      initialValues: {\n        walletAddress: \"\"\n      },\n      validationSchema: walletSchema,\n      onSubmit: values => {\n        if (values) {\n          onSubmitHandler(values.walletAddress);\n        }\n      }\n    });\n    return /*#__PURE__*/_jsxDEV(Box, {\n      children: [/*#__PURE__*/_jsxDEV(FormControl, {\n        onSubmit: formik.handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          id: \"walletAddress\",\n          name: \"walletAddress\",\n          type: \"text\",\n          placeholder: \"XRP Wallet Address\",\n          onChange: formik.handleChange,\n          value: formik.values.walletAddress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormHelperText, {\n          size: \"sm\",\n          children: formik.touched.walletAddress && formik.errors.walletAddress ? formik.errors.walletAddress : \"Please check XRP wallet address where to receive XRP from customer\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        mt: 4,\n        onClick: formik.handleSubmit // onClick={async () => {\n        //   formik.handleSubmit;\n        //   onSubmitHandler();\n        // }}\n        ,\n        type: \"submit\",\n        size: \"sm\",\n        colorScheme: \"messenger\",\n        children: \"Submit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this);\n  };\n\n  _s(XrpAddressInput, \"B/4rI4IXClQ7sG7psKj+pOuRe5Q=\", false, function () {\n    return [useFormik];\n  });\n\n  const disableWidget = async () => {\n    try {\n      await destroyScripts(shop);\n      toast({\n        title: `Widget removed successfully!`,\n        status: \"success\"\n      });\n      getScripts(shop);\n    } catch (e) {\n      toast({\n        title: e.message || INTERNAL_SERVER_ERROR,\n        status: \"error\"\n      });\n    }\n  };\n\n  const renderButton = () => {\n    if (scripts.get.loading) {\n      return /*#__PURE__*/_jsxDEV(Button, {\n        colorScheme: \"gray\",\n        isLoading: true,\n        isDisabled: true,\n        children: \"Loading ...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this);\n    } else if (scripts.get.success.data.length) {\n      return /*#__PURE__*/_jsxDEV(Button, {\n        isLoading: scripts.destroy.loading || scripts.get.loading,\n        fontWeight: \"bold\",\n        size: \"sm\",\n        colorScheme: \"red\",\n        onClick: disableWidget,\n        children: \"Remove Widget From Your Store\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 9\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(Button, {\n        isLoading: scripts.post.loading || scripts.get.loading,\n        fontWeight: \"bold\",\n        size: \"sm\",\n        colorScheme: \"green\",\n        onClick: enableWidget,\n        children: \"Add Widget To Your Store\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(NavBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      maxW: \"7xl\",\n      p: [12, 6],\n      bg: \"#f6f6f7\",\n      textAlign: \"left\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        as: \"section\",\n        maxW: \"3xl\",\n        mx: \"auto\",\n        children: /*#__PURE__*/_jsxDEV(SimpleGrid, {\n          spacing: 4,\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            bg: \"white\",\n            borderRadius: 10,\n            p: 5,\n            boxShadow: \"md\",\n            children: XrpAddressInput()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            bg: \"white\",\n            borderRadius: 10,\n            p: 5,\n            boxShadow: \"md\",\n            children: [/*#__PURE__*/_jsxDEV(Text, {\n              size: \"xl\",\n              fontWeight: \"bold\",\n              children: \"Widget Embed Settings\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Text, {\n              mt: \"4\",\n              fontSize: \"sm\",\n              children: \"Enable or disable \\\"Shop the look\\\" widget on your store. The widget gets appended to the bottom of your store page above the footer on the home page.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ButtonGroup, {\n              mt: \"4\",\n              spacing: \"6\",\n              children: renderButton()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Alert, {\n              mt: 4,\n              status: \"info\",\n              children: [/*#__PURE__*/_jsxDEV(AlertIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(SimpleGrid, {\n                children: [/*#__PURE__*/_jsxDEV(Box, {\n                  children: /*#__PURE__*/_jsxDEV(Text, {\n                    fontSize: \"sm\",\n                    children: \"NOTE: If you want the widget only on certain pages or only in certain positions please add the following html tag to custom liquid or custom html section.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 243,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Box, {\n                  children: /*#__PURE__*/_jsxDEV(Code, {\n                    children: `<div id=\"frangout-shop-look-app\"> </div>`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s2(SettingsRoute, \"s0DU3+svpHyVORf0NAKy30ACun8=\", false, function () {\n  return [useScriptsStore, useScriptsStore, useScriptsStore, useScriptsStore, useToast, useWalletStore, useWalletStore];\n});\n\n_c = SettingsRoute;\nexport default SettingsRoute;\n\nvar _c;\n\n$RefreshReg$(_c, \"SettingsRoute\");","map":{"version":3,"sources":["/Users/jithendra/Desktop/Work/meta-soft-xrp/xrp-shopify-coupon-client/src/routes/settings/index.js"],"names":["useEffect","useContext","useState","Box","Heading","ButtonGroup","Text","Button","Container","useToast","Code","Divider","Input","FormControl","InputLeftElement","InputGroup","FormHelperText","Alert","AlertIcon","SimpleGrid","useScriptsStore","ShopContext","INTERNAL_SERVER_ERROR","NavBar","Form","useFormik","Yup","WAValidator","useWalletStore","Parse","SettingsRoute","shop","scripts","state","postScripts","getScripts","destroyScripts","toast","xrpAddress","setXrpAddress","xrpWalletAddress","walletState","postWalletAddress","fetchData","query","Query","fullText","ascending","result","find","then","results","console","log","length","catch","error","onSubmitHandler","data","address","valid","validate","title","status","post","success","ok","duration","enableWidget","e","message","walletSchema","object","shape","walletAddress","string","required","XrpAddressInput","formik","initialValues","validationSchema","onSubmit","values","handleSubmit","handleChange","touched","errors","disableWidget","renderButton","get","loading","destroy"],"mappings":"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","sourcesContent":["import { useEffect, useContext, useState } from \"react\";\nimport {\n  Box,\n  Heading,\n  ButtonGroup,\n  Text,\n  Button,\n  Container,\n  useToast,\n  Code,\n  Divider,\n  Input,\n  FormControl,\n  InputLeftElement,\n  InputGroup,\n  FormHelperText,\n  Alert,\n  AlertIcon,\n  SimpleGrid,\n} from \"@chakra-ui/react\";\nimport useScriptsStore from \"../../store/scripts\";\nimport { ShopContext } from \"../../context\";\nimport { INTERNAL_SERVER_ERROR } from \"../../constants/strings\";\nimport NavBar from \"../../components/navbar\";\nimport { Form, useFormik } from \"formik\";\nimport * as Yup from \"yup\";\nimport WAValidator from \"multicoin-address-validator\";\nimport useWalletStore from \"../../store/wallet\";\nimport Parse from \"parse\";\n\nconst SettingsRoute = () => {\n  const shop = useContext(ShopContext);\n  const scripts = useScriptsStore((state) => state.scripts);\n  const postScripts = useScriptsStore((state) => state.postScripts);\n  const getScripts = useScriptsStore((state) => state.getScripts);\n  const destroyScripts = useScriptsStore((state) => state.destroyScripts);\n  const toast = useToast();\n\n  const [xrpAddress, setXrpAddress] = useState();\n  const xrpWalletAddress = useWalletStore((state) => state.walletState);\n  const postWalletAddress = useWalletStore((state) => state.postWalletAddress);\n\n\n  useEffect(() => {\n      const fetchData = async () => {\n        const query = new Parse.Query('WalletDetails');\n        query.fullText('shop', shop);\n        query.ascending('createdAt')\n        const result = await query.find().then(function(results) {\n          // console.log(result);\n          console.log('Successfully got' + result.length + 'Data');\n        })\n        .catch(function(error) {\n          // There was an error.\n        });;\n        // console.log('Successfully got' + result.length + 'Data');\n        // for(const i=0; i<result.length; i++){\n        //   const object = result[i];\n        //   alert(object.id + ' - ' + object.get('shop'));\n        // }\n      }\n      fetchData();\n  });\n\n  const onSubmitHandler = (data) => {\n    const address = data;\n     const valid = WAValidator.validate(address, \"ripple\");\n        if (valid === true) {\n          toast({\n            title: \"Wallet Address Is Valid\",\n            status: \"success\",\n          });\n          postWalletAddress({shop, address});\n          if(xrpWalletAddress.post.success.ok === true){\n            toast({\n              title: 'Wallet address added successfully!',\n              status: 'success',\n              duration: 9000,\n            })\n          } else{\n            toast({\n              title: 'Wallet Address not added! Please try after sometime',\n              status: 'error',\n              duration: 9000,\n            })\n          }\n        } else {\n          toast({\n            title: \"Wallet Address is Invalid\",\n            status: \"error\",\n          });\n        }\n    \n  };\n\n  \n\n  useEffect(() => {\n    getScripts(shop);\n  }, []);\n\n  const enableWidget = async () => {\n    try {\n      await postScripts(shop);\n      toast({\n        title: `Widget added successfully! Please visit your online store after 30 seconds to check the widget.`,\n        status: \"success\",\n      });\n      getScripts(shop);\n    } catch (e) {\n      toast({\n        title: e.message || INTERNAL_SERVER_ERROR,\n        status: \"error\",\n      });\n    }\n  };\n\n  const walletSchema = Yup.object().shape({\n    walletAddress: Yup.string().required(\"Wallet Address Is required\"),\n  });\n\n  const XrpAddressInput = () => {\n    const formik = useFormik({\n      initialValues: { walletAddress: \"\" },\n      validationSchema: walletSchema,\n      onSubmit: (values) => {\n        if (values){\n          onSubmitHandler(values.walletAddress);\n        }\n       \n      },\n    });\n    return (\n      <Box>\n        <FormControl onSubmit={formik.handleSubmit}>\n          <Input\n            id=\"walletAddress\"\n            name=\"walletAddress\"\n            type=\"text\"\n            placeholder=\"XRP Wallet Address\"\n            onChange={formik.handleChange}\n            value={formik.values.walletAddress}\n          />\n          <FormHelperText size=\"sm\">\n            {formik.touched.walletAddress && formik.errors.walletAddress\n              ? formik.errors.walletAddress\n              : \"Please check XRP wallet address where to receive XRP from customer\"}\n          </FormHelperText>\n        </FormControl>\n\n        <Button\n          mt={4}\n          onClick={formik.handleSubmit}\n          // onClick={async () => {\n          //   formik.handleSubmit;\n          //   onSubmitHandler();\n          // }}\n          type=\"submit\"\n          size=\"sm\"\n          colorScheme={\"messenger\"}\n        >\n          Submit\n        </Button>\n      </Box>\n    );\n  };\n\n  const disableWidget = async () => {\n    try {\n      await destroyScripts(shop);\n      toast({\n        title: `Widget removed successfully!`,\n        status: \"success\",\n      });\n      getScripts(shop);\n    } catch (e) {\n      toast({\n        title: e.message || INTERNAL_SERVER_ERROR,\n        status: \"error\",\n      });\n    }\n  };\n\n  const renderButton = () => {\n    if (scripts.get.loading) {\n      return (\n        <Button colorScheme=\"gray\" isLoading isDisabled>\n          Loading ...\n        </Button>\n      );\n    } else if (scripts.get.success.data.length) {\n      return (\n        <Button\n          isLoading={scripts.destroy.loading || scripts.get.loading}\n          fontWeight=\"bold\"\n          size=\"sm\"\n          colorScheme=\"red\"\n          onClick={disableWidget}\n        >\n          Remove Widget From Your Store\n        </Button>\n      );\n    } else {\n      return (\n        <Button\n          isLoading={scripts.post.loading || scripts.get.loading}\n          fontWeight=\"bold\"\n          size=\"sm\"\n          colorScheme=\"green\"\n          onClick={enableWidget}\n        >\n          Add Widget To Your Store\n        </Button>\n      );\n    }\n  };\n\n  return (\n    <>\n      <NavBar />\n      <Container maxW={\"7xl\"} p={[12, 6]} bg=\"#f6f6f7\" textAlign={\"left\"}>\n        <Box as=\"section\" maxW=\"3xl\" mx=\"auto\">\n          <SimpleGrid spacing={4}>\n            <Box bg=\"white\" borderRadius={10} p={5} boxShadow=\"md\">\n              {XrpAddressInput()}\n            </Box>\n            <Box bg=\"white\" borderRadius={10} p={5} boxShadow=\"md\">\n              <Text size=\"xl\" fontWeight=\"bold\">\n                Widget Embed Settings\n              </Text>\n              <Text mt=\"4\" fontSize=\"sm\">\n                Enable or disable \"Shop the look\" widget on your store. The\n                widget gets appended to the bottom of your store page above the\n                footer on the home page.\n              </Text>\n              <ButtonGroup mt=\"4\" spacing=\"6\">\n                {renderButton()}\n              </ButtonGroup>\n              <Alert mt={4} status=\"info\">\n                <AlertIcon />\n                <SimpleGrid>\n                  <Box>\n                    <Text fontSize=\"sm\">\n                      NOTE: If you want the widget only on certain pages or only\n                      in certain positions please add the following html tag to\n                      custom liquid or custom html section.\n                    </Text>\n                  </Box>\n                  <Box>\n                    <Code\n                      children={`<div id=\"frangout-shop-look-app\"> </div>`}\n                    ></Code>\n                  </Box>\n                </SimpleGrid>\n              </Alert>\n            </Box>\n          </SimpleGrid>\n        </Box>\n      </Container>\n    </>\n  );\n};\n\nexport default SettingsRoute;\n"]},"metadata":{},"sourceType":"module"}