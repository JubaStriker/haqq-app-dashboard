{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NonSnakeCaseGroup = exports.findMatchInEnum = exports.forEachInEnum = exports.getMergedProps = exports.updateActionFromPayload = exports.ActionSetWithChildren = exports.ActionSet = exports.isValidOptionalString = exports.isValidOptionalNumber = exports.getEventNameSpace = exports.getVersion = exports.actionWrapper = void 0;\n\nvar types_1 = require(\"../client/types\");\n\nvar collection_1 = require(\"../util/collection\");\n\nvar Error_1 = require(\"./Error\");\n\nvar constants_1 = require(\"./constants\");\n\nvar merge_1 = __importDefault(require(\"./merge\"));\n\nvar types_2 = require(\"./types\");\n\nvar uuid_1 = __importDefault(require(\"./uuid\")); // eslint-disable-next-line @typescript-eslint/no-var-requires\n\n\nvar packageJson = require('../package.json');\n\nfunction actionWrapper(action) {\n  return __assign(__assign({}, action), {\n    version: getVersion(),\n    clientInterface: {\n      name: packageJson.name,\n      version: getVersion()\n    }\n  });\n}\n\nexports.actionWrapper = actionWrapper;\n\nfunction getVersion() {\n  return packageJson.version;\n}\n\nexports.getVersion = getVersion;\n/**\n * Returns full event name with prefix, group, subgroups and type formatted with separators\n * @internal\n * */\n\nfunction getEventNameSpace(group, eventName, component) {\n  if (eventName.startsWith(\"\" + constants_1.PREFIX + constants_1.SEPARATOR)) {\n    return eventName;\n  }\n\n  var eventNameSpace = groupToEventNameSpace(group);\n\n  if (component) {\n    var subgroups_1 = component.subgroups,\n        type = component.type;\n\n    if (subgroups_1 && subgroups_1.length > 0) {\n      eventNameSpace += eventNameSpace.length > 0 ? constants_1.SEPARATOR : '';\n      subgroups_1.forEach(function (subgroup, index) {\n        eventNameSpace += \"\" + subgroup.toUpperCase() + (index < subgroups_1.length - 1 ? constants_1.SEPARATOR : '');\n      });\n    }\n\n    if (type !== group && type) {\n      eventNameSpace += \"\" + (eventNameSpace.length > 0 ? constants_1.SEPARATOR : '') + type.toUpperCase();\n    }\n  }\n\n  if (eventNameSpace) {\n    eventNameSpace += \"\" + (eventNameSpace.length > 0 ? constants_1.SEPARATOR : '') + eventName.toUpperCase();\n  }\n\n  return \"\" + constants_1.PREFIX + constants_1.SEPARATOR + eventNameSpace;\n}\n\nexports.getEventNameSpace = getEventNameSpace;\n\nfunction isValidOptionalNumber(value) {\n  return value === null || value === undefined || typeof value === 'number';\n}\n\nexports.isValidOptionalNumber = isValidOptionalNumber;\n\nfunction isValidOptionalString(value) {\n  return value === null || value === undefined || typeof value === 'string';\n}\n\nexports.isValidOptionalString = isValidOptionalString;\n\nvar ActionSet =\n/** @class */\nfunction () {\n  function ActionSet(app, type, group, id) {\n    var _this = this;\n\n    this.app = app;\n    this.type = type;\n    this.group = group;\n    this.subgroups = [];\n    this.subscriptions = [];\n\n    if (!app) {\n      Error_1.throwError(Error_1.Action.INVALID_ACTION, 'Missing required `app`');\n    }\n\n    this.id = id || uuid_1.default();\n    this.defaultGroup = group;\n    var defaultSet = this.set;\n\n    this.set = function () {\n      var _a;\n\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!_this.app.hooks) {\n        return defaultSet.apply(_this, args);\n      }\n\n      return (_a = _this.app.hooks).run.apply(_a, __spreadArrays([types_1.LifecycleHook.UpdateAction, defaultSet, _this], args));\n    };\n  }\n\n  ActionSet.prototype.set = function () {\n    var _ = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      _[_i] = arguments[_i];\n    }\n  };\n\n  Object.defineProperty(ActionSet.prototype, \"component\", {\n    get: function () {\n      return {\n        id: this.id,\n        subgroups: this.subgroups,\n        type: this.type\n      };\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  ActionSet.prototype.updateSubscription = function (subscriptionToRemove, group, subgroups) {\n    var eventType = subscriptionToRemove.eventType,\n        callback = subscriptionToRemove.callback,\n        component = subscriptionToRemove.component;\n    var currentIndex;\n    currentIndex = this.subscriptions.findIndex(function (subscription) {\n      return subscription === subscriptionToRemove;\n    });\n\n    if (currentIndex >= 0) {\n      this.subscriptions[currentIndex].unsubscribe();\n    } else {\n      currentIndex = undefined;\n    }\n\n    this.group = group;\n    this.subgroups = subgroups;\n    Object.assign(component, {\n      subgroups: this.subgroups\n    });\n    return this.subscribe(eventType, callback, component, currentIndex);\n  };\n\n  ActionSet.prototype.error = function (callback) {\n    var _this = this;\n\n    var subscriptionIndices = [];\n    forEachInEnum(Error_1.Action, function (eventNameSpace) {\n      // Keep track of subscription index so we can call unsubscribe later\n      // This ensure it will continue to work even when the subscription has been updated\n      subscriptionIndices.push(_this.subscriptions.length);\n\n      _this.subscribe(eventNameSpace, callback);\n    });\n    return function () {\n      var subscriptionsToRemove = subscriptionIndices.map(function (index) {\n        return _this.subscriptions[index];\n      });\n      subscriptionsToRemove.forEach(function (toRemove) {\n        collection_1.removeFromCollection(_this.subscriptions, toRemove, function (removed) {\n          removed.unsubscribe();\n        });\n      });\n    };\n  };\n\n  ActionSet.prototype.subscribe = function (eventName, callback, component, currentIndex) {\n    var _this = this;\n\n    var eventComponent = component || this.component;\n    var eventType = eventName.toUpperCase();\n    var boundedCallback = typeof currentIndex === 'number' ? callback : callback.bind(this);\n    var eventNameSpace;\n\n    if (Error_1.isErrorEventName(eventName)) {\n      eventNameSpace = getEventNameSpace(types_2.Group.Error, eventName, __assign(__assign({}, eventComponent), {\n        type: ''\n      }));\n    } else {\n      eventNameSpace = getEventNameSpace(this.group, eventName, eventComponent);\n    }\n\n    var unsubscribe = this.app.subscribe(eventNameSpace, boundedCallback, component ? component.id : this.id);\n    var subscription = {\n      eventType: eventType,\n      unsubscribe: unsubscribe,\n      callback: boundedCallback,\n      component: eventComponent,\n      updateSubscribe: function (group, subgroups) {\n        return _this.updateSubscription(subscription, group, subgroups);\n      }\n    };\n\n    if (typeof currentIndex === 'number' && currentIndex >= 0 && currentIndex < this.subscriptions.length) {\n      this.subscriptions[currentIndex] = subscription;\n    } else {\n      this.subscriptions.push(subscription);\n    }\n\n    return unsubscribe;\n  };\n\n  ActionSet.prototype.unsubscribe = function (resetOnly) {\n    if (resetOnly === void 0) {\n      resetOnly = false;\n    }\n\n    unsubscribeActions(this.subscriptions, this.defaultGroup, resetOnly);\n    return this;\n  };\n\n  return ActionSet;\n}();\n\nexports.ActionSet = ActionSet;\n\nvar ActionSetWithChildren =\n/** @class */\nfunction (_super) {\n  __extends(ActionSetWithChildren, _super);\n\n  function ActionSetWithChildren() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.children = [];\n    return _this;\n  }\n\n  ActionSetWithChildren.prototype.unsubscribe = function (unsubscribeChildren, resetParentOnly) {\n    if (unsubscribeChildren === void 0) {\n      unsubscribeChildren = true;\n    }\n\n    if (resetParentOnly === void 0) {\n      resetParentOnly = false;\n    }\n\n    unsubscribeActions(this.subscriptions, this.defaultGroup, resetParentOnly);\n    this.children.forEach(function (child) {\n      if (child instanceof ActionSetWithChildren) {\n        child.unsubscribe(unsubscribeChildren, !unsubscribeChildren);\n      } else {\n        child.unsubscribe(!unsubscribeChildren);\n      }\n    });\n    return this;\n  };\n\n  ActionSetWithChildren.prototype.getChild = function (id) {\n    var childIndex = this.children.findIndex(function (child) {\n      return child.id === id;\n    });\n    return childIndex >= 0 ? this.children[childIndex] : undefined;\n  };\n\n  ActionSetWithChildren.prototype.getChildIndex = function (id) {\n    return this.children.findIndex(function (child) {\n      return child.id === id;\n    });\n  };\n\n  ActionSetWithChildren.prototype.getChildSubscriptions = function (id, eventType) {\n    return this.subscriptions.filter(function (sub) {\n      return sub.component.id === id && (!eventType || eventType === sub.eventType);\n    });\n  };\n\n  ActionSetWithChildren.prototype.addChild = function (child, group, subgroups) {\n    var _this = this;\n\n    var subscriptions = child.subscriptions;\n    var existingChild = this.getChild(child.id); // Add child if it doesn't already exist\n\n    if (!existingChild) {\n      this.children.push(child);\n    }\n\n    if (!subscriptions || group === child.group && subgroups === child.subgroups) {\n      return this;\n    }\n\n    subscriptions.forEach(function (subscription) {\n      var updateSubscribe = subscription.updateSubscribe;\n      updateSubscribe(group, subgroups);\n    }); // Update child's group and subgroups\n\n    Object.assign(child, {\n      group: group,\n      subgroups: subgroups\n    }); // Update child's children subscriptions\n\n    if (child instanceof ActionSetWithChildren) {\n      child.children.forEach(function (childIter) {\n        return _this.addChild(childIter, group, subgroups);\n      });\n    }\n\n    return this;\n  };\n\n  ActionSetWithChildren.prototype.removeChild = function (id) {\n    var _this = this;\n\n    collection_1.removeFromCollection(this.children, this.getChild(id), function () {\n      var toBeRemoved = _this.subscriptions.filter(function (subs) {\n        return subs.component.id === id;\n      });\n\n      toBeRemoved.forEach(function (toRemove) {\n        collection_1.removeFromCollection(_this.subscriptions, toRemove, function (removed) {\n          removed.unsubscribe();\n        });\n      });\n    });\n    return this;\n  };\n\n  ActionSetWithChildren.prototype.subscribeToChild = function (child, eventName, callback) {\n    var _this = this;\n\n    var boundedCallback = callback.bind(this);\n\n    if (eventName instanceof Array) {\n      eventName.forEach(function (eventNameIter) {\n        return _this.subscribeToChild(child, eventNameIter, callback);\n      });\n      return this;\n    }\n\n    if (typeof eventName !== 'string') {\n      return this;\n    }\n\n    var eventType = eventName.toUpperCase();\n    var currentSubscriptions = this.getChildSubscriptions(child.id, eventType);\n\n    if (currentSubscriptions.length > 0) {\n      // Subscription is already there, simply update it\n      currentSubscriptions.forEach(function (subs) {\n        return subs.updateSubscribe(_this.group, child.subgroups);\n      });\n    } else {\n      var childComponent = {\n        id: child.id,\n        subgroups: child.subgroups,\n        type: child.type\n      };\n      this.subscribe(eventType, boundedCallback, childComponent);\n    }\n\n    return this;\n  };\n\n  ActionSetWithChildren.prototype.getUpdatedChildActions = function (newActions, currentActions) {\n    if (newActions.length === 0) {\n      while (currentActions.length > 0) {\n        var action = currentActions.pop();\n\n        if (!action) {\n          break;\n        }\n\n        this.removeChild(action.id);\n      }\n\n      return undefined;\n    } // Only allow unique actions\n\n\n    var uniqueActions = newActions.filter(function (action, index, actionsArr) {\n      return index === actionsArr.indexOf(action);\n    });\n    var newActionIds = uniqueActions.map(function (action) {\n      return action.id;\n    }); // Remove unused actions\n\n    var unusedActions = currentActions.filter(function (action) {\n      return newActionIds.indexOf(action.id) < 0;\n    });\n\n    while (unusedActions.length > 0) {\n      var action = unusedActions.pop();\n\n      if (!action) {\n        break;\n      }\n\n      this.removeChild(action.id);\n    }\n\n    return uniqueActions;\n  };\n\n  return ActionSetWithChildren;\n}(ActionSet);\n\nexports.ActionSetWithChildren = ActionSetWithChildren;\n\nfunction unsubscribeActions(subscriptions, defaultGroup, reassign) {\n  if (reassign === void 0) {\n    reassign = false;\n  }\n\n  subscriptions.forEach(function (subscription) {\n    if (reassign) {\n      var updateSubscribe = subscription.updateSubscribe; // eslint-disable-next-line no-warning-comments\n      // TODO: Support cases where we don't wipe out group and subgroups to defaults\n\n      updateSubscribe(defaultGroup, []);\n    } else {\n      var unsubscribe = subscription.unsubscribe;\n      unsubscribe();\n    }\n  });\n\n  if (!reassign) {\n    subscriptions.length = 0;\n  }\n}\n\nfunction updateActionFromPayload(action, newProps) {\n  var id = action.id;\n\n  if (id === newProps.id) {\n    // Merge new properties\n    Object.assign(action, getMergedProps(action, newProps));\n    return true;\n  }\n\n  return false;\n}\n\nexports.updateActionFromPayload = updateActionFromPayload;\n\nfunction getMergedProps(props, newProps) {\n  var merged = merge_1.default(props, newProps);\n\n  if (!merged) {\n    // tslint:disable-next-line:prefer-object-spread\n    var cloned = Object.assign(props, newProps);\n    return cloned;\n  }\n\n  return merged;\n}\n\nexports.getMergedProps = getMergedProps;\n\nfunction forEachInEnum(types, callback) {\n  Object.keys(types).forEach(function (key) {\n    callback(types[key]);\n  });\n}\n\nexports.forEachInEnum = forEachInEnum;\n\nfunction findMatchInEnum(types, lookup) {\n  var match = Object.keys(types).find(function (key) {\n    return lookup === types[key];\n  });\n  return match ? types[match] : undefined;\n}\n\nexports.findMatchInEnum = findMatchInEnum;\n\nfunction camelCaseToSnakeCase(value) {\n  return value.replace(/([A-Z])/g, function (matcher, _val, index) {\n    return \"\" + (index === 0 ? '' : '_') + matcher[0].toLowerCase();\n  });\n}\n\nexports.NonSnakeCaseGroup = [types_2.Group.AuthCode, types_2.Group.Button, types_2.Group.ButtonGroup, types_2.Group.Cart, types_2.Group.Error, types_2.Group.Features, types_2.Group.Fullscreen, types_2.Group.Link, types_2.Group.Loading, types_2.Group.Menu, types_2.Group.Modal, types_2.Group.Navigation, types_2.Group.Pos, types_2.Group.Print, types_2.Group.ResourcePicker, types_2.Group.Scanner, types_2.Group.SessionToken, types_2.Group.Share, types_2.Group.TitleBar, types_2.Group.Toast];\n/**\n * Maps the group name to its event name\n * @internal\n * @remarks - This method is necessary for the new pattern of using snake case\n * which makes it more readable and easier to reconstruct the group from an event name.\n * Example: `ContextualSaveBar` becomes `CONTEXTUAL_SAVE_BAR`\n * */\n\nfunction groupToEventNameSpace(group) {\n  if (exports.NonSnakeCaseGroup.includes(group)) {\n    return group.toUpperCase();\n  }\n\n  return camelCaseToSnakeCase(group).toUpperCase();\n}","map":{"version":3,"sources":["/Users/jithendra/Desktop/Work/hbar-shop/hbar-shopify-coupon-client/node_modules/@shopify/app-bridge/actions/helper.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__spreadArrays","il","r","k","a","j","jl","__importDefault","mod","__esModule","defineProperty","exports","value","NonSnakeCaseGroup","findMatchInEnum","forEachInEnum","getMergedProps","updateActionFromPayload","ActionSetWithChildren","ActionSet","isValidOptionalString","isValidOptionalNumber","getEventNameSpace","getVersion","actionWrapper","types_1","require","collection_1","Error_1","constants_1","merge_1","types_2","uuid_1","packageJson","action","version","clientInterface","name","group","eventName","component","startsWith","PREFIX","SEPARATOR","eventNameSpace","groupToEventNameSpace","subgroups_1","subgroups","type","forEach","subgroup","index","toUpperCase","undefined","app","id","_this","subscriptions","throwError","Action","INVALID_ACTION","default","defaultGroup","defaultSet","set","_a","args","_i","hooks","run","LifecycleHook","UpdateAction","_","get","enumerable","configurable","updateSubscription","subscriptionToRemove","eventType","callback","currentIndex","findIndex","subscription","unsubscribe","subscribe","error","subscriptionIndices","push","subscriptionsToRemove","map","toRemove","removeFromCollection","removed","eventComponent","boundedCallback","bind","isErrorEventName","Group","Error","updateSubscribe","resetOnly","unsubscribeActions","_super","children","unsubscribeChildren","resetParentOnly","child","getChild","childIndex","getChildIndex","getChildSubscriptions","filter","sub","addChild","existingChild","childIter","removeChild","toBeRemoved","subs","subscribeToChild","eventNameIter","currentSubscriptions","childComponent","getUpdatedChildActions","newActions","currentActions","pop","uniqueActions","actionsArr","indexOf","newActionIds","unusedActions","reassign","newProps","props","merged","cloned","types","keys","key","lookup","match","find","camelCaseToSnakeCase","replace","matcher","_val","toLowerCase","AuthCode","Button","ButtonGroup","Cart","Features","Fullscreen","Link","Loading","Menu","Modal","Navigation","Pos","Print","ResourcePicker","Scanner","SessionToken","Share","TitleBar","Toast","includes"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NonSnakeCaseGroup = exports.findMatchInEnum = exports.forEachInEnum = exports.getMergedProps = exports.updateActionFromPayload = exports.ActionSetWithChildren = exports.ActionSet = exports.isValidOptionalString = exports.isValidOptionalNumber = exports.getEventNameSpace = exports.getVersion = exports.actionWrapper = void 0;\nvar types_1 = require(\"../client/types\");\nvar collection_1 = require(\"../util/collection\");\nvar Error_1 = require(\"./Error\");\nvar constants_1 = require(\"./constants\");\nvar merge_1 = __importDefault(require(\"./merge\"));\nvar types_2 = require(\"./types\");\nvar uuid_1 = __importDefault(require(\"./uuid\"));\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nvar packageJson = require('../package.json');\nfunction actionWrapper(action) {\n    return __assign(__assign({}, action), { version: getVersion(), clientInterface: {\n            name: packageJson.name,\n            version: getVersion(),\n        } });\n}\nexports.actionWrapper = actionWrapper;\nfunction getVersion() {\n    return packageJson.version;\n}\nexports.getVersion = getVersion;\n/**\n * Returns full event name with prefix, group, subgroups and type formatted with separators\n * @internal\n * */\nfunction getEventNameSpace(group, eventName, component) {\n    if (eventName.startsWith(\"\" + constants_1.PREFIX + constants_1.SEPARATOR)) {\n        return eventName;\n    }\n    var eventNameSpace = groupToEventNameSpace(group);\n    if (component) {\n        var subgroups_1 = component.subgroups, type = component.type;\n        if (subgroups_1 && subgroups_1.length > 0) {\n            eventNameSpace += eventNameSpace.length > 0 ? constants_1.SEPARATOR : '';\n            subgroups_1.forEach(function (subgroup, index) {\n                eventNameSpace += \"\" + subgroup.toUpperCase() + (index < subgroups_1.length - 1 ? constants_1.SEPARATOR : '');\n            });\n        }\n        if (type !== group && type) {\n            eventNameSpace += \"\" + (eventNameSpace.length > 0 ? constants_1.SEPARATOR : '') + type.toUpperCase();\n        }\n    }\n    if (eventNameSpace) {\n        eventNameSpace += \"\" + (eventNameSpace.length > 0 ? constants_1.SEPARATOR : '') + eventName.toUpperCase();\n    }\n    return \"\" + constants_1.PREFIX + constants_1.SEPARATOR + eventNameSpace;\n}\nexports.getEventNameSpace = getEventNameSpace;\nfunction isValidOptionalNumber(value) {\n    return value === null || value === undefined || typeof value === 'number';\n}\nexports.isValidOptionalNumber = isValidOptionalNumber;\nfunction isValidOptionalString(value) {\n    return value === null || value === undefined || typeof value === 'string';\n}\nexports.isValidOptionalString = isValidOptionalString;\nvar ActionSet = /** @class */ (function () {\n    function ActionSet(app, type, group, id) {\n        var _this = this;\n        this.app = app;\n        this.type = type;\n        this.group = group;\n        this.subgroups = [];\n        this.subscriptions = [];\n        if (!app) {\n            Error_1.throwError(Error_1.Action.INVALID_ACTION, 'Missing required `app`');\n        }\n        this.id = id || uuid_1.default();\n        this.defaultGroup = group;\n        var defaultSet = this.set;\n        this.set = function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (!_this.app.hooks) {\n                return defaultSet.apply(_this, args);\n            }\n            return (_a = _this.app.hooks).run.apply(_a, __spreadArrays([types_1.LifecycleHook.UpdateAction, defaultSet, _this], args));\n        };\n    }\n    ActionSet.prototype.set = function () {\n        var _ = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            _[_i] = arguments[_i];\n        }\n    };\n    Object.defineProperty(ActionSet.prototype, \"component\", {\n        get: function () {\n            return {\n                id: this.id,\n                subgroups: this.subgroups,\n                type: this.type,\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ActionSet.prototype.updateSubscription = function (subscriptionToRemove, group, subgroups) {\n        var eventType = subscriptionToRemove.eventType, callback = subscriptionToRemove.callback, component = subscriptionToRemove.component;\n        var currentIndex;\n        currentIndex = this.subscriptions.findIndex(function (subscription) { return subscription === subscriptionToRemove; });\n        if (currentIndex >= 0) {\n            this.subscriptions[currentIndex].unsubscribe();\n        }\n        else {\n            currentIndex = undefined;\n        }\n        this.group = group;\n        this.subgroups = subgroups;\n        Object.assign(component, { subgroups: this.subgroups });\n        return this.subscribe(eventType, callback, component, currentIndex);\n    };\n    ActionSet.prototype.error = function (callback) {\n        var _this = this;\n        var subscriptionIndices = [];\n        forEachInEnum(Error_1.Action, function (eventNameSpace) {\n            // Keep track of subscription index so we can call unsubscribe later\n            // This ensure it will continue to work even when the subscription has been updated\n            subscriptionIndices.push(_this.subscriptions.length);\n            _this.subscribe(eventNameSpace, callback);\n        });\n        return function () {\n            var subscriptionsToRemove = subscriptionIndices.map(function (index) { return _this.subscriptions[index]; });\n            subscriptionsToRemove.forEach(function (toRemove) {\n                collection_1.removeFromCollection(_this.subscriptions, toRemove, function (removed) {\n                    removed.unsubscribe();\n                });\n            });\n        };\n    };\n    ActionSet.prototype.subscribe = function (eventName, callback, component, currentIndex) {\n        var _this = this;\n        var eventComponent = component || this.component;\n        var eventType = eventName.toUpperCase();\n        var boundedCallback = typeof currentIndex === 'number' ? callback : callback.bind(this);\n        var eventNameSpace;\n        if (Error_1.isErrorEventName(eventName)) {\n            eventNameSpace = getEventNameSpace(types_2.Group.Error, eventName, __assign(__assign({}, eventComponent), { type: '' }));\n        }\n        else {\n            eventNameSpace = getEventNameSpace(this.group, eventName, eventComponent);\n        }\n        var unsubscribe = this.app.subscribe(eventNameSpace, boundedCallback, component ? component.id : this.id);\n        var subscription = {\n            eventType: eventType,\n            unsubscribe: unsubscribe,\n            callback: boundedCallback,\n            component: eventComponent,\n            updateSubscribe: function (group, subgroups) {\n                return _this.updateSubscription(subscription, group, subgroups);\n            },\n        };\n        if (typeof currentIndex === 'number' &&\n            currentIndex >= 0 &&\n            currentIndex < this.subscriptions.length) {\n            this.subscriptions[currentIndex] = subscription;\n        }\n        else {\n            this.subscriptions.push(subscription);\n        }\n        return unsubscribe;\n    };\n    ActionSet.prototype.unsubscribe = function (resetOnly) {\n        if (resetOnly === void 0) { resetOnly = false; }\n        unsubscribeActions(this.subscriptions, this.defaultGroup, resetOnly);\n        return this;\n    };\n    return ActionSet;\n}());\nexports.ActionSet = ActionSet;\nvar ActionSetWithChildren = /** @class */ (function (_super) {\n    __extends(ActionSetWithChildren, _super);\n    function ActionSetWithChildren() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.children = [];\n        return _this;\n    }\n    ActionSetWithChildren.prototype.unsubscribe = function (unsubscribeChildren, resetParentOnly) {\n        if (unsubscribeChildren === void 0) { unsubscribeChildren = true; }\n        if (resetParentOnly === void 0) { resetParentOnly = false; }\n        unsubscribeActions(this.subscriptions, this.defaultGroup, resetParentOnly);\n        this.children.forEach(function (child) {\n            if (child instanceof ActionSetWithChildren) {\n                child.unsubscribe(unsubscribeChildren, !unsubscribeChildren);\n            }\n            else {\n                child.unsubscribe(!unsubscribeChildren);\n            }\n        });\n        return this;\n    };\n    ActionSetWithChildren.prototype.getChild = function (id) {\n        var childIndex = this.children.findIndex(function (child) { return child.id === id; });\n        return childIndex >= 0 ? this.children[childIndex] : undefined;\n    };\n    ActionSetWithChildren.prototype.getChildIndex = function (id) {\n        return this.children.findIndex(function (child) { return child.id === id; });\n    };\n    ActionSetWithChildren.prototype.getChildSubscriptions = function (id, eventType) {\n        return this.subscriptions.filter(function (sub) { return sub.component.id === id && (!eventType || eventType === sub.eventType); });\n    };\n    ActionSetWithChildren.prototype.addChild = function (child, group, subgroups) {\n        var _this = this;\n        var subscriptions = child.subscriptions;\n        var existingChild = this.getChild(child.id);\n        // Add child if it doesn't already exist\n        if (!existingChild) {\n            this.children.push(child);\n        }\n        if (!subscriptions || (group === child.group && subgroups === child.subgroups)) {\n            return this;\n        }\n        subscriptions.forEach(function (subscription) {\n            var updateSubscribe = subscription.updateSubscribe;\n            updateSubscribe(group, subgroups);\n        });\n        // Update child's group and subgroups\n        Object.assign(child, { group: group, subgroups: subgroups });\n        // Update child's children subscriptions\n        if (child instanceof ActionSetWithChildren) {\n            child.children.forEach(function (childIter) {\n                return _this.addChild(childIter, group, subgroups);\n            });\n        }\n        return this;\n    };\n    ActionSetWithChildren.prototype.removeChild = function (id) {\n        var _this = this;\n        collection_1.removeFromCollection(this.children, this.getChild(id), function () {\n            var toBeRemoved = _this.subscriptions.filter(function (subs) { return subs.component.id === id; });\n            toBeRemoved.forEach(function (toRemove) {\n                collection_1.removeFromCollection(_this.subscriptions, toRemove, function (removed) {\n                    removed.unsubscribe();\n                });\n            });\n        });\n        return this;\n    };\n    ActionSetWithChildren.prototype.subscribeToChild = function (child, eventName, callback) {\n        var _this = this;\n        var boundedCallback = callback.bind(this);\n        if (eventName instanceof Array) {\n            eventName.forEach(function (eventNameIter) { return _this.subscribeToChild(child, eventNameIter, callback); });\n            return this;\n        }\n        if (typeof eventName !== 'string') {\n            return this;\n        }\n        var eventType = eventName.toUpperCase();\n        var currentSubscriptions = this.getChildSubscriptions(child.id, eventType);\n        if (currentSubscriptions.length > 0) {\n            // Subscription is already there, simply update it\n            currentSubscriptions.forEach(function (subs) { return subs.updateSubscribe(_this.group, child.subgroups); });\n        }\n        else {\n            var childComponent = {\n                id: child.id,\n                subgroups: child.subgroups,\n                type: child.type,\n            };\n            this.subscribe(eventType, boundedCallback, childComponent);\n        }\n        return this;\n    };\n    ActionSetWithChildren.prototype.getUpdatedChildActions = function (newActions, currentActions) {\n        if (newActions.length === 0) {\n            while (currentActions.length > 0) {\n                var action = currentActions.pop();\n                if (!action) {\n                    break;\n                }\n                this.removeChild(action.id);\n            }\n            return undefined;\n        }\n        // Only allow unique actions\n        var uniqueActions = newActions.filter(function (action, index, actionsArr) { return index === actionsArr.indexOf(action); });\n        var newActionIds = uniqueActions.map(function (action) { return action.id; });\n        // Remove unused actions\n        var unusedActions = currentActions.filter(function (action) {\n            return newActionIds.indexOf(action.id) < 0;\n        });\n        while (unusedActions.length > 0) {\n            var action = unusedActions.pop();\n            if (!action) {\n                break;\n            }\n            this.removeChild(action.id);\n        }\n        return uniqueActions;\n    };\n    return ActionSetWithChildren;\n}(ActionSet));\nexports.ActionSetWithChildren = ActionSetWithChildren;\nfunction unsubscribeActions(subscriptions, defaultGroup, reassign) {\n    if (reassign === void 0) { reassign = false; }\n    subscriptions.forEach(function (subscription) {\n        if (reassign) {\n            var updateSubscribe = subscription.updateSubscribe;\n            // eslint-disable-next-line no-warning-comments\n            // TODO: Support cases where we don't wipe out group and subgroups to defaults\n            updateSubscribe(defaultGroup, []);\n        }\n        else {\n            var unsubscribe = subscription.unsubscribe;\n            unsubscribe();\n        }\n    });\n    if (!reassign) {\n        subscriptions.length = 0;\n    }\n}\nfunction updateActionFromPayload(action, newProps) {\n    var id = action.id;\n    if (id === newProps.id) {\n        // Merge new properties\n        Object.assign(action, getMergedProps(action, newProps));\n        return true;\n    }\n    return false;\n}\nexports.updateActionFromPayload = updateActionFromPayload;\nfunction getMergedProps(props, newProps) {\n    var merged = merge_1.default(props, newProps);\n    if (!merged) {\n        // tslint:disable-next-line:prefer-object-spread\n        var cloned = Object.assign(props, newProps);\n        return cloned;\n    }\n    return merged;\n}\nexports.getMergedProps = getMergedProps;\nfunction forEachInEnum(types, callback) {\n    Object.keys(types).forEach(function (key) {\n        callback(types[key]);\n    });\n}\nexports.forEachInEnum = forEachInEnum;\nfunction findMatchInEnum(types, lookup) {\n    var match = Object.keys(types).find(function (key) {\n        return lookup === types[key];\n    });\n    return match ? types[match] : undefined;\n}\nexports.findMatchInEnum = findMatchInEnum;\nfunction camelCaseToSnakeCase(value) {\n    return value.replace(/([A-Z])/g, function (matcher, _val, index) {\n        return \"\" + (index === 0 ? '' : '_') + matcher[0].toLowerCase();\n    });\n}\nexports.NonSnakeCaseGroup = [\n    types_2.Group.AuthCode,\n    types_2.Group.Button,\n    types_2.Group.ButtonGroup,\n    types_2.Group.Cart,\n    types_2.Group.Error,\n    types_2.Group.Features,\n    types_2.Group.Fullscreen,\n    types_2.Group.Link,\n    types_2.Group.Loading,\n    types_2.Group.Menu,\n    types_2.Group.Modal,\n    types_2.Group.Navigation,\n    types_2.Group.Pos,\n    types_2.Group.Print,\n    types_2.Group.ResourcePicker,\n    types_2.Group.Scanner,\n    types_2.Group.SessionToken,\n    types_2.Group.Share,\n    types_2.Group.TitleBar,\n    types_2.Group.Toast,\n];\n/**\n * Maps the group name to its event name\n * @internal\n * @remarks - This method is necessary for the new pattern of using snake case\n * which makes it more readable and easier to reconstruct the group from an event name.\n * Example: `ContextualSaveBar` becomes `CONTEXTUAL_SAVE_BAR`\n * */\nfunction groupToEventNameSpace(group) {\n    if (exports.NonSnakeCaseGroup.includes(group)) {\n        return group.toUpperCase();\n    }\n    return camelCaseToSnakeCase(group).toUpperCase();\n}\n"]},"metadata":{},"sourceType":"script"}